#
# define display information
#
name: Design Pool 

tooltip: |
    Run FEBA Perl Scripts Map-TnSeq and Design Random Pool (Morgan Price)


screenshots: []

icon: design_pool.png

#
# define a set of similar apps that might be useful to the user
#
suggestions:
    apps:
        related:
            [app1, app2]
        next:
            [app3, app4]

#
# Configure the display and description of parameters
#
parameters :
    genome_ref :
        ui-name : |
            Target Genome   
        short-hint : |
            The Genome you're checking your reads against to find locations of barcodes.
        long-hint  : |
            This is the genome to whose genes we are going to match barcodes so they can be used to measure the abundance of strains with those genes interrupted.
    fastq_ref :
        ui-name : |
            FastQ Mapping Reads
        short-hint : |
            The reads in Fastq format as a KBase Single End Library Object.
        long-hint  : |
            The Map Tn Seq Program takes a set of Reads objects and maps the embedded barcodes to a location in the genome.
    model_name :
        ui-name : |
            Model Name 
        short-hint : |
            The name of the model file you'll be using.
        long-hint  : |
            The model file has a specific format. You may be able to use one of the existing models,
            or you can upload a custom one by choosing Custom.
    test_mode :
        ui-name: |
            Test Mode?
        short-hint : |
            Run the program on the first 100 lines of your reads to check if your model is correct.
        long-hint : |
            In order to save time looking for the correct model, simply run 
            Test Mode on various models until you find one that matches.
            If Test Mode is on, the program will not create a KBase Pool File.
    custom_model_string :
        ui-name : |
            Custom Model Text 
        short-hint : |
            The text for your custom model. Must follow the format in description.
        long-hint  : |
            If you chose "Custom" as your model, then you must input the text for the model. Examples given
            in the app description, including format restrictions.
    minN :
        ui-name : |
            minN
        short-hint : |
            An integer. minimum number of "good" reads for a barcode supporting its mapping.
        long-hint : |
            (Int) An optional input to the Design Random Pool program. minN is the minimum number of "good" reads for a barcode supporting
            its mapping.  (Good means a unique hit to the genome and qBeg=1.) Must be greater than 1.
    minFrac :
        ui-name : |
            minFrac
        short-hint : |
            A float. minFrac is the minimum fraction of input reads for the barcode that
            agree with the preferred mapping. Must be between 0 and 1
        long-hint : |
            (Float) An optional input to Design Random Pool. minFrac is the minimum fraction of input reads for the barcode that
            agree with the preferred mapping. Must be between 0 and 1.
    minRatio :
        ui-name : |
            minRatio
        short-hint : |
            A float. minRatio is the minimum ratio of
            reads for preferred mapping over the 2nd-most-frequent mapping. Must be greater than 0.
        long-hint : |
            (Float) An optional input to Design Random Pool. minRatio is the minimum ratio of reads for preferred mapping over the 2nd-most-frequent mapping. Must be greater than 0.
    pool_description :
        ui-name : |
            Pool Description
        short-hint : |
            Give a brief description of your poolfile. Only necessary when uploading
            KBase Pool.
        long-hint : |
            This description is used to understand where pool files come from 
            and their purpose. Please use only letters, spaces, and numbers.
    KB_Pool_Bool :
        ui-name : |
            Create KBase PoolFile Object?
        short-hint : |
            Automatically create a KBase Poolfile object to be used in
            future RBTnSeq analysis programs such as Reads to PoolCount.
        long-hint : |
            You can choose to create a KBase Poolfile object to be used in
            future RBTnSeq analysis runs such as Reads to PoolCount. Select yes
            if you believe this poolfile is the one you will be using in the 
            future.
    output_name :
        ui-name : |
           Output Name 
        short-hint : |
            The name of your output files.
        long-hint  : |
            Give a name with no spaces or special characters.



description : |
    <p>A KBase Wrapper for Morgan Prices's <a href="https://bitbucket.org/berkeleylab/feba/src/master/"> MapTnSeq code. </a></p>
    <p>The specific scripts from the feba code used are </p>
    <p> bin/MapTnSeq.pl, bin/DesignRandomPool,
     lib/FEBA_Utils.pm, lib/PoolStats.R</p>
    <p>The output of the program is a pool file, which you can choose to be 
    made into a KBase Object. It will be returned to you in a zipped directory
    either way (as long as you don't choose test-run). </p>
    <p> Test-run is for checking if the Reads and the Genome are related</p>
    <p> The output map-tnseq files are tab-delimited and contain, for each usable \n
    read, the read name, the barcode, which scaffold the insertion \n
    lies in, the position of the insertion, the strand that the read \n
    matched, a boolean flag for if this mapping location is unique or \n
    not, the beginning and end of the hit to the genome in the read \n
    after trimming the transposon sequence, the bit score, and the \n
    %identity. </p>
    <p> The gene-table file "map_tn_seq_gene_table.tsv" contains the following columns: \n
    scaffoldId, (begin) base-pair location for starting, (end) base-pair location for \n
    the end, strand (+/-), description (free text description), LocusID, and type, \n
    (for type, "1" means it is a protein coding gene). </p>

 
